#!/bin/bash
GCC=""
echo -n "checking for gcc... "
if [ -x `which gcc` ]; then
  echo `which gcc`
else
  echo "no"
  echo "error: no gcc found"
  exit 1
fi
echo -n "checking whether gcc supports -march=i386... "
if echo |gcc -march=i386 -E - 2> /dev/null > /dev/null; then
  echo yes
  GCC=""
else
  echo no
  echo -n "checking for a gcc that is compatible with -march=i386... "
  if echo|i686-pc-linux-gnu-gcc -march=i386 -E - 2> /dev/null > /dev/null; then
    echo `which i686-pc-linux-gnu-gcc`
    GCC="CC=i686-pc-linux-gnu-gcc\n"
    GCC="${GCC}AS=i686-pc-linux-gnu-as\n"
    GCC="${GCC}LD=i686-pc-linux-gnu-ld"
  else
    echo "none found"
    echo "error: no compatilbe gcc found"
    exit 1
  fi
fi
echo "creating Makefile.in"
echo -e "${GCC}" > Makefile.in
echo "Good - your configure finished. Start make now"